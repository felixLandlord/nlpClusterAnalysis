# nlpClusterAnalysis

## NLP Clustering with HDBSCAN

This program processes a CSV file containing names, generates embeddings for those names using a pre-trained model(**_sentence-transformers/all-mpnet-base-v2_**), and clusters them using the **_HDBSCAN_** algorithm. 

The results, including cluster ids and potential noise points, are saved to CSV files.


## Overview

This project focuses on clustering similar names based on semantic embeddings generated by the **_sentence-transformers/all-mpnet-base-v2_** model, creating a 768-dimensional representation for each name. 

Using **_HDBSCAN_**, a density-based clustering algorithm, it groups names with similar meanings or structures while labeling outliers as noise. 

The process begins by loading the dataset from a CSV file, preprocessing the data to handle missing values, and performing basic exploratory data analysis (EDA) to understand its structure. Embeddings are then generated, clustered, and saved into two output CSV filesâ€”one including noise labels and another without.

### Evaluation Metric

The **_silhouette score_** is a metric used to evaluate the quality of clusters by measuring how well-separated and well-defined they are.
It ranges from -1 to 1, where a higher score indicates better-defined clusters. A score close to 1 means that data points are well-matched within their cluster and distinct from neighboring clusters.
A score near 0 suggests overlapping clusters, while negative scores indicate that points may be in the wrong clusters.


## Disclaimer

This project aimed to balance several clustering objectives, including maximizing the **silhouette score**, minimizing the number of clusters, and ensuring high-quality groupings. 
While efforts were made to achieve a well-defined clustering of names, compromises were necessary to optimize across these goals. 
In some cases, clusters may have been merged or outliers labeled as noise to maintain a manageable number of clusters with clear boundaries. 
As such, the clustering results represent an optimized trade-off and may not perfectly capture every subtle variation in the data. 

Also, results are highly dependent on the quality of the embeddings, other factors such as: tuning the parameters of the **_HDBSCAN_** algorithm may help achieve a better clustering.

**Users are encouraged to adjust parameters based on their specific use cases for optimal results**.



## Requirements

- Python 3.10 and above
- `pandas`
- `numpy==1.26.4`
- `scikit-learn`
- `hdbscan`
- `langchain`
- `langchain_huggingface`
- `sentence-transformers`


## Usage 

Note : Example free & open-source huggingFace embeddings models you can use:
- **_all-mpnet-base-v2_**: Requires approximately 438.7 MB     [`used in this project`]

- **_all-MiniLM-L6-v2_**: Requires approximately 91.6 MB


1. **Clone the repository**:

```bash
git clone https://github.com/felixLandlord/nlpClusterAnalysis.git
cd nlpClusterAnalysis
```

2. **Create a virtual environment**:
```bash
python -m venv .venv
```

3. **Activate the virtual environment**:

**MacOS**:
```bash
source .venv/bin/activate
```

**Windows**:
```CMD
.venv\Scripts\activate
```

**Linux**:
```bash
source .venv/bin/activate
```

4. **Install the required dependencies**:
```bash
pip install -r requirements.txt
```

5. **Running the clustering program**:

This script will start processing the input data to generate the output CSV file with the cluster ids.
```bash
python cluster.py
```
**Enter the path to the input CSV file**: /path/to/your/input.csv

**Enter the directory to save the output files**: /path/to/output/directory


## Colab Notebook
You can also run the clustering program in a Google Colab notebook. Here is an example of how to do it:

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1EUCQybhnxmnM-tWqtv0nICHZ8zGmqiPt?usp=sharing)


## References

- [HDBSCAN](https://scikit-learn.org/1.5/modules/generated/sklearn.cluster.HDBSCAN.html)
- [langchain](https://python.langchain.com/docs/introduction/)
- [langchain_huggingface](https://python.langchain.com/api_reference/huggingface/embeddings/langchain_huggingface.embeddings.huggingface.HuggingFaceEmbeddings.html)
- [Hugging Face Transformers](https://huggingface.co/sentence-transformers/all-mpnet-base-v2)
- [Scikit-learn](https://scikit-learn.org/1.5/modules/generated/sklearn.metrics.silhouette_score.html)
- [Pandas](https://pandas.pydata.org/)
- [NumPy](https://numpy.org/)